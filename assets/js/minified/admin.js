"use strict";(function(wp,$){"use strict";if(!wp){return}var __=wp.i18n.__;var admin={cache:function cache(){this.els={};this.vars={};this.vars.protect="woocommerce_woo-paddle-gateway_is_readonly";this.vars.sandbox="woocommerce_woo-paddle-gateway_sandbox_mode";this.vars.refresh="refresh-responses";this.vars.verify="[for*=\"_vendor_verify\"]";this.els.$protect=$("#".concat(this.vars.protect));this.els.$sandbox=$("#".concat(this.vars.sandbox));this.els.$verify=$(".forminp ".concat(this.vars.verify));this.els.$refresh=$("#".concat(this.vars.refresh))},init:function init(){this.cache();this.bindEvents();this.showConnectionStatus();this.handleOnToggleProtect();this.handleOnToggleSandbox()},bindEvents:function bindEvents(){this.els.$protect.on("click",this.handleOnToggleProtect);this.els.$sandbox.on("click",this.handleOnToggleSandbox);this.els.$refresh.on("click",this.handleOnRefreshResponses)},handleOnToggleProtect:function handleOnToggleProtect(){var isChecked=admin.els.$protect.is(":checked");admin.alterFields("[name*=\"_vendor_\"]:not(.disabled)",{readonly:isChecked?"readonly":null})},handleOnToggleSandbox:function handleOnToggleSandbox(){var isChecked=admin.els.$sandbox.is(":checked");var visible="table-row";var hidden="none";admin.alterFields("[name*=\"_test_\"]",{style:"display: ".concat(isChecked?visible:hidden)},"tr");admin.alterFields("[name*=\"_live_\"]",{style:"display: ".concat(isChecked?hidden:visible)},"tr")},handleOnRefreshResponses:function handleOnRefreshResponses(event){event.preventDefault();if(!confirm(__("Are you sure you want to refresh the responses?","woo-paddle-gateway"))){return}var $this=$(this);var $wrapper=$this.parent();$.ajax({url:ajaxurl,type:"POST",data:{action:"woo_paddle_gateway_refresh_responses",_ajax_nonce:$("#_wpnonce").val()},beforeSend:function beforeSend(){$this.replaceWith("<span class=\"spinner\"></span>")},success:function success(_ref){var message=_ref.data.message;$wrapper.html("<span class=\"dashicons dashicons-yes\"></span> ".concat(message))},error:function error(_ref2){var message=_ref2.responseJSON.data.message;$wrapper.html("<span class=\"dashicons dashicons-no\"></span> ".concat(message))}})},showConnectionStatus:function showConnectionStatus(){if(!this.els.$verify.length){return}this.els.$verify.each(function(index,element){var $this=$(element);var $input=$this.find("input");var isChecked=$input.is(":checked")?"1":"0";var labels=$input.data("label");var replacement=labels[isChecked];$this.contents().filter(function(index,el){return el.nodeType===3}).each(function(index,el){el.nodeValue=el.nodeValue.replace("\u2026",replacement)})})},alterFields:function alterFields(selector,attrs,parent){var $fields=$(selector);if(!$fields.length){return}$fields.each(function(index,element){var $selector=$(element);if(parent){$selector=$selector.closest(parent)}$selector.attr(attrs)})}};admin.init()})(window.wp,jQuery,ajaxurl);